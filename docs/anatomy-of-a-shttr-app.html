<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2026-01-20T20:16:56.777219"><title>Anatomy of a Shttr App | Shttr Docs</title><script type="application/json" id="virtual-toc-data">[{"id":"shttr-project-base-directory-structure","level":0,"title":"Shttr Project Base Directory Structure","anchor":"#shttr-project-base-directory-structure"},{"id":"dockerfile","level":0,"title":"Dockerfile","anchor":"#dockerfile"},{"id":"cgi-bin","level":0,"title":"cgi-bin","anchor":"#cgi-bin"},{"id":"config-sh","level":0,"title":"config.sh","anchor":"#config-sh"},{"id":"node-modules","level":0,"title":"node_modules","anchor":"#node-modules"},{"id":"shttr-app-assets","level":0,"title":"shttr/app/assets","anchor":"#shttr-app-assets"},{"id":"shttr-app-controllers","level":0,"title":"shttr/app/controllers","anchor":"#shttr-app-controllers"},{"id":"shttr-app-globals-sh","level":0,"title":"shttr/app/globals.sh","anchor":"#shttr-app-globals-sh"},{"id":"shttr-app-models","level":0,"title":"shttr/app/models","anchor":"#shttr-app-models"},{"id":"shttr-app-views","level":0,"title":"shttr/app/views","anchor":"#shttr-app-views"},{"id":"bin","level":0,"title":"bin","anchor":"#bin"},{"id":"lib","level":0,"title":"lib","anchor":"#lib"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Anatomy of a Shttr App | Shttr Docs"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Shttr Docs Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/anatomy-of-a-shttr-app.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Anatomy of a Shttr App | Shttr Docs"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/anatomy-of-a-shttr-app.html#webpage",
    "url": "writerside-documentation/anatomy-of-a-shttr-app.html",
    "name": "Anatomy of a Shttr App | Shttr Docs",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Shttr Docs Help"
}</script><!-- End Schema.org --></head><body data-id="Anatomy-of-a-Shttr-App" data-main-title="Anatomy of a Shttr App" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Shttr Docs  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Anatomy-of-a-Shttr-App" id="Anatomy-of-a-Shttr-App.md">Anatomy of a Shttr App</h1><section class="chapter"><h2 id="shttr-project-base-directory-structure" data-toc="shttr-project-base-directory-structure">Shttr Project Base Directory Structure</h2><p id="-n0u832_15">Upon creating a new Shttr project, you'll end up with a directory structure that approximates what follows. This section will go into detail about what each directory or file does.</p><div class="code-block" data-lang="none">
├── Dockerfile.dev
├── Dockerfile.prod
├── README.md
├── cgi-bin
│   ├── about.sh
│   └── index.sh
├── config.sh
├── node_modules
├── package-lock.json
├── package.json
└── shttr
    ├── app
    │   ├── assets
    │   │   ├── images
    │   │   │   ├── github-mark-white.png
    │   │   │   └── github-mark.png
    │   │   ├── package.json
    │   │   ├── public
    │   │   │   └── style-c338dd97768b97ae3a7e1bf8d1f39cd601b15f5fdd09a35564b153029f675b66.css
    │   │   ├── scripts
    │   │   │   └── vendored
    │   │   │       └── turbo.js
    │   │   └── stylesheets
    │   │       └── vendored
    │   │           └── pico.scss
    │   ├── controllers
    │   │   ├── about.sh
    │   │   └── index.sh
    │   ├── globals.sh
    │   ├── models
    │   │   ├── about.sh
    │   │   └── index.sh
    │   └── views
    │       ├── about
    │       │   └── index.md
    │       ├── about.sh
    │       ├── index
    │       │   └── index.md
    │       ├── index.sh
    │       └── shared
    │           ├── app.html
    │           ├── btm.html
    │           └── nav.html
    ├── bin
    └── lib
</div></section><section class="chapter"><h2 id="dockerfile" data-toc="dockerfile">Dockerfile</h2><p id="-n0u832_17">A Shttr project contains two Dockerfiles: <code class="code" id="-n0u832_18">Dockerfile.dev</code> and <code class="code" id="-n0u832_19">Dockerfile.prod</code>. These seperate Dockerfiles are used to build the development and production images of you project respectively. The difference between the two Dockerfiles is that Dockerfile.dev bind-mounts the <code class="code" id="-n0u832_20">cgi-bin</code> and <code class="code" id="-n0u832_21">shttr</code> directories in the image which allows for live-reloading changes without having to restart the server, whereas Dockerfile.prod copies the app files into the image which creates an image that is read-only as long as it's running. Managing these two Dockerfiles requires no intervention on the part of the app developer. When starting the server, ShttrCLI will automatically symlink <code class="code" id="-n0u832_22">Dockerfile</code> to <code class="code" id="-n0u832_23">Dockerfile.dev</code> or <code class="code" id="-n0u832_24">Dockerfile.prod</code> depending on whether or not <code class="code" id="-n0u832_25">--production</code> was passed, and in deployment, <code class="code" id="-n0u832_26">Dockerfile.prod</code> will be pushed to the deployment target as <code class="code" id="-n0u832_27">Dockerfile</code> automatically.</p></section><section class="chapter"><h2 id="cgi-bin" data-toc="cgi-bin">cgi-bin</h2><p id="-n0u832_28">The <code class="code" id="-n0u832_29">cgi-bin</code> directory is one of the key app directories, though it doesn't typically require any user-intervention. Shttr does not utilize a router like many other popular frameworks, instead Shttr using entrypoint scripts that live in <code class="code" id="-n0u832_30">cgi-bin</code>. Using <code class="code" id="-n0u832_31">shttr g page</code> will automatically create the proper entrypoint script for your new page, and these entrypoints can be navigated to in your views using <code class="code" id="-n0u832_32">/cgi-bin/page.sh</code> as the URL. Each entrypoint script should be identical; their job is simply to set up certain key environment variables that need to exist prior to executing the main Shttr script, they then pass execution off to the main Shttr script. It's very rare that any of these scripts should need to be modified.</p></section><section class="chapter"><h2 id="config-sh" data-toc="config-sh">config.sh</h2><p id="-n0u832_33">The <code class="code" id="-n0u832_34">config.sh</code> file contains project-specific configuration options used by ShttrCLI. At the moment, it contains deployment options and supports the following two parameters: <code class="code" id="-n0u832_35">DEPLOYMENT_TARGET</code> and <code class="code" id="-n0u832_36">SSH_ADDRESS</code>. <code class="code" id="-n0u832_37">DEPLOYMENT_TARGET</code> determines the app's deployment target, currently there is one supported value: <code class="code" id="-n0u832_38">systemd</code>, which deploys the production Docker image to a web server as a SystemD service. <code class="code" id="-n0u832_39">SSH_ADDRESS</code> sets the username and address of the server where the Docker image and SystemD service is to be deployed. It takes the standard format <code class="code" id="-n0u832_40">user@example.com</code>.</p></section><section class="chapter"><h2 id="node-modules" data-toc="node-modules">node_modules</h2><p id="-n0u832_41">The <code class="code" id="-n0u832_42">node_modules</code> directory, as well as the <code class="code" id="-n0u832_43">package.json</code> and <code class="code" id="-n0u832_44">package-lock.json</code> files in the root of your project directory contain build-time NodeJS package dependencies which are used to build your app but do not need to be bundled with it in deployment. These build dependencies are managed by ShttrCLI and should not be modified.</p></section><section class="chapter"><h2 id="shttr-app-assets" data-toc="shttr-app-assets">shttr/app/assets</h2><p id="-n0u832_45">This directory contains static assets to be used by your Shttr pages. The directory can be accessed by your views using the environment variable <code class="code" id="-n0u832_51">SHTTR_ASSETS</code>.</p><section class="chapter"><h3 id="images" data-toc="images">images</h3><p id="-n0u832_52">The <code class="code" id="-n0u832_53">images</code> directory contains images that can be used on your pages. The src URL in your img tag would look like <code class="code" id="-n0u832_54">${SHTTR_ASSETS}/images/image.png</code>.</p></section><section class="chapter"><h3 id="node-packages-package-json-package-lock-json" data-toc="node-packages-package-json-package-lock-json">node_packages, package.json, package-lock.json</h3><p id="-n0u832_55">These directories and files contain NodeJS runtime packages for your project. These <span class="emphasis" id="-n0u832_56">will</span> be bundled with your app in deployment. The <code class="code" id="-n0u832_57">shttr npm</code> command controls packages installed here, and any package installed and imported in a page can be accessed using the variable <code class="code" id="-n0u832_58">node_package-name</code>. The <code class="code" id="-n0u832_59">node_package-name</code> variable points to the package's installation directory, so for example, if we'd installed the Turn library using <code class="code" id="-n0u832_60">shttr npm i @domchristie/turn</code> and we'd imported the library using <code class="code" id="-n0u832_61">use @domchristie/turn</code>, we'd have access to the variable <code class="code" id="-n0u832_62">node_turn</code> which would expand to <code class="code" id="-n0u832_63">/app/assets/node_modules/@domchristie/turn</code>. This variable would be used within our pages or in an importmap to access the Node package.</p></section><section class="chapter"><h3 id="public" data-toc="public">public</h3><p id="-n0u832_64">This directory contains the compiled stylesheet which is used by the view pages. When assets are compiled using either <code class="code" id="-n0u832_65">shttr d -c</code> or <code class="code" id="-n0u832_66">shttr c</code>, all stylesheets used by the project are compiled into one .css file named with a checksum digest. A link to this file is then automatically injected into the head of each view by default. Note that only one .css file can exist in this directory at a time, otherwise the automatic linking will fail.</p></section><section class="chapter"><h3 id="scripts" data-toc="scripts">scripts</h3><p id="-n0u832_67">This directory contains Javascript files to be used by your views. Any script in the <code class="code" id="-n0u832_68">vendored</code> subdirectory will be injected into the head of each page automatically by default. Any scripts outside <code class="code" id="-n0u832_69">vendored</code> will need to be explicitly loaded into a script tag using <code class="code" id="-n0u832_70">${SHTTR_ASSETS}/scripts/script.js</code> as the src URL.</p></section><section class="chapter"><h3 id="stylesheets" data-toc="stylesheets">stylesheets</h3><p id="-n0u832_71">This directory contains the source stylesheets that are to be modified by the app developer. All .css and .scss files within the <code class="code" id="-n0u832_72">stylesheets</code> directory and any subdirectories will be compiled into one big .css file named with a checksum digest and placed under <code class="code" id="-n0u832_73">public</code> for use by the running app. This compilation is triggered by running <code class="code" id="-n0u832_74">shttr d -c</code> or <code class="code" id="-n0u832_75">shttr c</code>.</p></section></section><section class="chapter"><h2 id="shttr-app-controllers" data-toc="shttr-app-controllers">shttr/app/controllers</h2><p id="-n0u832_76">This directory contains the controller script for each page. A basic controller script will just set the page title, run the model, and then run the view script. Controllers can get quite involved on complex pages, while the proper documentation is in progress, see the code for <a href="https://calebstein.net" id="-n0u832_77" data-external="true" rel="noopener noreferrer" target="_blank">calebstein.net</a> <a href="https://github.com/calebstein1/calebstein-web" id="-n0u832_78" data-external="true" rel="noopener noreferrer" target="_blank">here</a> for examples.</p></section><section class="chapter"><h2 id="shttr-app-globals-sh" data-toc="shttr-app-globals-sh">shttr/app/globals.sh</h2><p id="-n0u832_79">This file is run on every page load in the app. It's a good spot to declare any modules that will be needed by every page, or to do any global prep work based on saved cookies.</p></section><section class="chapter"><h2 id="shttr-app-models" data-toc="shttr-app-models">shttr/app/models</h2><p id="-n0u832_80">The files in this directory correspond to files in the <code class="code" id="-n0u832_81">controllers</code> directory. Each controller runs its corresponding model in its environment, and while it's not strictly necessary to use the model script, it's there for teh sake of code organization.</p></section><section class="chapter"><h2 id="shttr-app-views" data-toc="shttr-app-views">shttr/app/views</h2><p id="-n0u832_82">Each page view has two components: a script and a directory of partials. The script uses the <code class="code" id="-n0u832_83">esh</code> module and shell logic to render the HTML response to the client. Each directory of partials contains component files, which can either be HTML files, or any file that Pandoc can convert to HTML. These files do not require use of a specific templating language, but any environment variables in them will be replaced with their proper values upon rendering by the <code class="code" id="-n0u832_84">esh</code> module.</p></section><section class="chapter"><h2 id="bin" data-toc="bin">bin</h2><p id="-n0u832_85">This contains the main Shttr executable script. After the entrypoint finishes, execution is handed to the <code class="code" id="-n0u832_86">shttr</code> script here, which further sets up the environment for the controller to take over. Do not modify files in this directory unless you really know what you're doing.</p></section><section class="chapter"><h2 id="lib" data-toc="lib">lib</h2><p id="-n0u832_87">This directory contains the modules that are imported by pages with the <code class="code" id="-n0u832_88">uae</code> command. If you were to write your own module, you could stick it here and access it with <code class="code" id="-n0u832_89">use</code>, but that's not really officially supported at the point so it's recommended to leave this directory alone. Just accept the magic ;)</p></section><div class="last-modified">22 March 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="shttr-cli.html" class="navigation-links__prev">Shttr CLI</a><a href="deploying-your-app.html" class="navigation-links__next">Deploying Your App</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>